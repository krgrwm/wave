#!/usr/bin/env zsh

zmodload zsh/mathfunc

t=1.0
x=0.4

for i in $(ls -d set/plane_wave_<->) ; do
    source $i
    source $data_dir/data.param
    export xn=$(( x / dx ))
    export n=$(( int(t / dt) ))
    export dx
    export dt
    export v
    echo -n $i $xn $dx $n $dt " "
    /bin/head -n 1 $data_dir/data_$n.dat \
        | /bin/perl -wnlae 'print abs($F[$ENV{xn}] + 0.1*sin(50.0/$ENV{v}*(($ENV{xn} - 1)*$ENV{dx} - $ENV{v}*($ENV{n}*$ENV{dt})))) '
done
